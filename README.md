# Описание

## Проект является выполением тестового задания

### Использованые технологии:
- Java 21
- Spring Boot 4.0.2
- Webflux
- Reactive Hibernate (R2Dbc)
- Liquibase

### Тесты:
- Junit
- TestSuite
- TestContainers
- Mockito


# Как запускать

1. Запускаются `mvn test` 
2. Поднимаются контейнеры `docker compose up -d`
3. Запускается сервис `mvn spring-boot:run`
4. Схемы базы данных загрузятся автоматически


# Утилита загрузки n документов
Утилиты лежат в директории tool. Они собраны под разные архитектуры
1. app_amd_windows
2. app_amd_linux 
3. app_arm_linux
4. app_arm_darwin (macOS)

Использование: `app_amd_windows <Путь-к-файлу>`

Файл должен содержать только число – количество документов к созданию.
В терминале будет выведен прогресс работы утилиты или ошибки

# REST-Запросы

В приложении есть swagger-ui, доступен [здесь](http://localhost:8080/swagger-ui/index.html) (http://localhost:8080/swagger-ui/index.html)

# Дополнительные вопросы

### Что бы вы поменяли, чтобы обработка одного запроса уверенно работала с 5000+ id?

Доработал бы классы repository для загрузки более одной записи за запрос. 
Метод saveAll в R2dbcRepository/ReactiveCrudRepository загружает записи по одной, поэтому требуется дополнительная доработка.

### Как бы вы вынесли реестр утверждений в отдельную систему (отдельная БД или отдельный HTTP-сервис)

Отдельный сервис с собственной БД и взаимодействием между сервисом документов и утверждений по gRPC или HTTP.

В идеале также подключить spring cloud gateway и discovery для удобства взаимодействия с API.

Если не требуется фиксированный результат (если статус 200 не означает, что документ останется в утвержеднном статусе при отсутствии внешнего взаимодействия) и важен только запуск процесса, то можно реализовать передачу данных через брокер сообщений (kafka, rabbitMQ). 
При утверждении отправлялось бы сообщение в топик о необходимости создания записи в реестре утверждений. В случае ошибки в топик ошибок отправлялось бы сообщение о невозможности создать запись. 
Сервис документов в этом случае бы откатывал изменения, если ошибка не связана с дублированием идентификатора документа в реестре утверждений. 
При удалении документа отправлялось бы сообщение о необходимости удалить запись из реестра утверждений.